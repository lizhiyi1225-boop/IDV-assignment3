<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Chart 8 (Simple Bars) - D3.js with Side Note</title>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<style>
  body {
    background:#e6ebeb;
    font-family: system-ui, sans-serif;
    margin: 0;
    padding: 40px;
  }

  /* 整体布局：左图右注释 */
  .container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    gap: 40px;
    max-width: 1200px;
    margin: auto;
  }

  svg {
    background:#fff;
    box-shadow:0 2px 8px rgba(0,0,0,.05);
    border-radius: 8px;
  }

  .bar-solid { fill:#e6cf6a; stroke:#555; stroke-width:1.5; }
  .bar-dashed { fill:none; stroke:#d9c164; stroke-width:2; stroke-dasharray:6,6; }
  .frame { fill:none; stroke:#333; stroke-width:1.6; }
  .tick-line { stroke:#333; stroke-width:1.4; }
  .label { font-size:12px; text-anchor:middle; }
  .tick-text { font-size:12px; }
  .title { font-size:16px; font-weight:600; text-anchor:middle; }
  .dimmed { opacity: .25; }
  .hot { cursor: pointer; }
  .tooltip {
    position:absolute; background:#fff; border:1px solid #ccc; border-radius:6px;
    padding:6px 10px; font-size:12px; pointer-events:none; box-shadow:0 2px 8px rgba(0,0,0,.08)
  }

  /* 右侧注释框 */
  .note {
    width: 340px;
    background:#fff;
    border-radius:10px;
    box-shadow:0 2px 8px rgba(0,0,0,0.08);
    padding:22px 26px;
    font-size:14px;
    line-height:1.6;
    color:#333;
  }
  .note h3 {
    text-align:center;
    font-size:17px;
    font-weight:600;
    margin-top:0;
    margin-bottom:10px;
  }

  @media (max-width:900px){
    .container { flex-direction: column; align-items: center; }
    .note { width:90%; margin-top:20px; }
  }
</style>
</head>
<body>
<div class="container">
  <!-- 图表部分 -->
  <svg width="640" height="480"></svg>

  <!-- 注释部分 -->
  <div class="note">
    <h3>How I made this chart with ChatGPT</h3>
    <p>In this D3.js project, I created <b>Chart 8 — Simple Bars</b>, showing <b>Cross Validation Accuracy (%)</b>.</p>
    <p>I used ChatGPT to build and improve the chart step by step. First, I told it to draw three models — <b>BERT</b>, <b>RoBERTa</b>, and <b>BART</b>, each with two bars, one solid and one dashed. The bars grow smoothly from the bottom and show their values on top.</p>
    <p>Then I asked ChatGPT to remove the axes and add a square frame, just like the sample image. Finally, I moved the “100” label and tick line slightly inside the box to match the example.</p>
    <p>After a few small fixes, the chart looked clean and matched the reference perfectly.</p>
  </div>
</div>

<script>
// === D3.js chart code (same as before) ===
const svg = d3.select("svg");
const margin = {top:60, right:40, bottom:70, left:60};
const width = +svg.attr("width") - margin.left - margin.right;
const height = +svg.attr("height") - margin.top - margin.bottom;
const g = svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);

const data = [
  {model:"BERT",    solid:74.4, dashed:64.8},
  {model:"RoBERTa", solid:81.9, dashed:65.5},
  {model:"BART",    solid:73.1, dashed:63.5}
];
const x = d3.scaleBand().domain(data.map(d=>d.model)).range([0,width]).padding(0.5);
const y = d3.scaleLinear().domain([0,100]).range([height,0]);

g.append("rect").attr("class","frame").attr("x",0).attr("y",0).attr("width",width).attr("height",height);
const y100 = height * 0.08;
const y0 = height;
g.append("text").attr("x",-25).attr("y",y0).attr("class","tick-text").text("0");
g.append("line").attr("class","tick-line").attr("x1",-5).attr("x2",0).attr("y1",y100).attr("y2",y100);
g.append("text").attr("x",-30).attr("y",y100+4).attr("class","tick-text").text("100");
g.append("text").attr("class","title").attr("x",width/2).attr("y",-20).text("Cross Validation Accuracy (%)");

const barWidth = x.bandwidth()/3;
const groups = g.selectAll(".g-model").data(data).enter()
  .append("g").attr("class","g-model")
  .attr("transform",d=>`translate(${x(d.model)},0)`);

const solid = groups.append("rect").attr("class","bar-solid hot")
  .attr("x",-barWidth/2).attr("y",height).attr("width",barWidth).attr("height",0)
  .transition().delay((_,i)=>i*120).duration(900).ease(d3.easeCubicOut)
  .attr("y",d=>y(d.solid)).attr("height",d=>height - y(d.solid));

const dashed = groups.append("rect").attr("class","bar-dashed hot")
  .attr("x",barWidth).attr("y",height).attr("width",barWidth).attr("height",0)
  .transition().delay((_,i)=>300 + i*120).duration(900).ease(d3.easeCubicOut)
  .attr("y",d=>y(d.dashed)).attr("height",d=>height - y(d.dashed));

const fmt = d3.format(".1f");
groups.append("text").attr("class","label").attr("x",0)
  .attr("y",d=>y(d.solid)-6).text(d=>fmt(d.solid));
groups.append("text").attr("class","label").attr("x",barWidth*1.5)
  .attr("y",d=>y(d.dashed)-6).text(d=>fmt(d.dashed));
groups.append("text").attr("class","label hot").attr("x",barWidth*0.5)
  .attr("y",height+25).text(d=>d.model);
</script>
</body>
</html>
