<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Chart 7 (Venn Diagram) — D3.js with Transition & Interaction</title>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
<script>
  if (!window.d3) {
    var s = document.createElement('script');
    s.src = 'https://unpkg.com/d3@7.9.0/dist/d3.min.js';
    document.head.appendChild(s);
  }
</script>
<style>
  body {background:#e6ebeb;font-family:system-ui,Arial;margin:0;padding:24px;}
  .wrap {display:flex;justify-content:center;align-items:flex-start;gap:28px;max-width:1200px;margin:auto;flex-wrap:wrap;}
  svg {background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06);border-radius:10px;}
  text {font-size:16px;font-weight:500;text-anchor:middle;dominant-baseline:middle;}
  .label{font-size:18px;font-weight:600;}
  .tooltip{position:absolute;background:#fff;border:1px solid #ccc;border-radius:6px;padding:6px 8px;font-size:12px;pointer-events:none;box-shadow:0 2px 6px rgba(0,0,0,.1);}
  .note{width:360px;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.06);border-radius:10px;padding:20px 24px;font-size:14px;line-height:1.6;}
  .note h3{font-size:18px;margin-top:0;}
  @media(max-width:900px){.wrap{flex-direction:column;align-items:center;}.note{width:100%;}}
</style>
</head>
<body>
<div class="wrap">
  <svg width="640" height="400"></svg>
  <div class="note">
    <h3>How I made this Venn chart with ChatGPT</h3>
    <p>I built <b>Chart 7 — Venn Diagram</b> to show the links between <b>Delete</b>, <b>Replace</b>, and <b>Rewrite</b>.</p>
    <p>ChatGPT helped me draw three semi-transparent circles (purple, gray, yellow) and name them. I added Roman numerals (I–VII) to mark each overlap region.</p>
    <p>On load, circles grow from radius 0 and texts fade in for a soft entrance. Hover shows a tooltip like “Region VI — Delete ∩ Rewrite”; related circles stay bright, others dim. Click to lock or unlock the highlight.</p>
    <p>I fine-tuned label positions (e.g., moved “VI” to the purple-yellow border) and learned D3 coordinate tweaks. Colors use low opacity (0.45) so overlaps are clear but comfortable to view.</p>
  </div>
</div>
<script>
const svg = d3.select("svg");
const circles = [
  {id:"Delete",key:"A",cx:250,cy:220,r:100,color:"rgba(160,140,220,0.45)"},
  {id:"Replace",key:"B",cx:330,cy:140,r:100,color:"rgba(150,130,130,0.45)"},
  {id:"Rewrite",key:"C",cx:410,cy:220,r:100,color:"rgba(240,220,120,0.45)"}
];
function regionLabel(inA,inB,inC){
  if(inA&&inB&&inC)return"VII";
  if(inA&&inB&&!inC)return"IV";
  if(!inA&&inB&&inC)return"V";
  if(inA&&!inB&&inC)return"VI";
  if(inA&&!inB&&!inC)return"I";
  if(!inA&&inB&&!inC)return"II";
  if(!inA&&!inB&&inC)return"III";
  return"";
}
const g=svg.append("g");
g.selectAll("circle").data(circles).enter().append("circle")
  .attr("cx",d=>d.cx).attr("cy",d=>d.cy).attr("r",0)
  .style("fill",d=>d.color).transition().duration(900).delay((_,i)=>i*120).attr("r",d=>d.r);
const labels=[
  {txt:"Delete",x:circles[0].cx-100,y:circles[0].cy+120},
  {txt:"Replace",x:circles[1].cx,y:circles[1].cy-120},
  {txt:"Rewrite",x:circles[2].cx+100,y:circles[2].cy+120}
];
g.selectAll(".label").data(labels).enter().append("text")
  .attr("class","label").attr("x",d=>d.x).attr("y",d=>d.y)
  .style("opacity",0).text(d=>d.txt)
  .transition().duration(600).delay(550).style("opacity",1);
const roman=[
  {text:"I",x:200,y:240},
  {text:"II",x:330,y:100},
  {text:"III",x:440,y:240},
  {text:"IV",x:270,y:180},
  {text:"V",x:370,y:180},
  {text:"VII",x:330,y:200},
  {text:"VI",x:340,y:250}
];
g.selectAll(".fixed").data(roman).enter().append("text")
  .attr("class","fixed").attr("x",d=>d.x).attr("y",d=>d.y)
  .style("opacity",0).text(d=>d.text)
  .transition().duration(600).delay(650).style("opacity",1);
const tooltip=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);
let locked=false;
function inside(d,x,y){const dx=x-d.cx,dy=y-d.cy;return dx*dx+dy*dy<=d.r*d.r;}
function highlightAt(x,y){
  const inA=inside(circles[0],x,y),inB=inside(circles[1],x,y),inC=inside(circles[2],x,y);
  const label=regionLabel(inA,inB,inC);
  svg.selectAll("circle").style("opacity",d=>{
    const on=(d.key==="A"&&inA)||(d.key==="B"&&inB)||(d.key==="C"&&inC);
    return label?(on?1:0.25):1;
  });
  if(label){
    const sets=[inA?"Delete":null,inB?"Replace":null,inC?"Rewrite":null].filter(Boolean).join(" ∩ ");
    tooltip.style("opacity",1).html(`<b>Region ${label}</b><br>${sets}`)
      .style("left",(x+14)+"px").style("top",(y+14)+"px");
  }else tooltip.style("opacity",0);
}
svg.on("mousemove",ev=>{if(locked)return;const pt=d3.pointer(ev,svg.node());highlightAt(pt[0],pt[1]);});
svg.on("mouseleave",()=>{if(!locked){svg.selectAll("circle").style("opacity",1);tooltip.style("opacity",0);}});
svg.on("click",ev=>{const pt=d3.pointer(ev,svg.node());if(!locked){highlightAt(pt[0],pt[1]);locked=true;}else{locked=false;svg.selectAll("circle").style("opacity",1);tooltip.style("opacity",0);}});
</script>
</body>
</html>